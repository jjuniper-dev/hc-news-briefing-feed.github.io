      - name: Test feeds
        id: health
        run: |
          python3 - << 'EOF'
-         import json, requests, feedparser
+         import os, json, requests, feedparser

          feeds = {
            "CBC Top Stories": "https://rss.cbc.ca/lineup/topstories.xml",
            "CTV Canada":      "https://www.ctvnews.ca/rss/ctvnews-ca-canada-1.2089050",
            "NPR US":          "https://feeds.npr.org/1001/rss.xml",
            "Reuters World":   "https://feeds.reuters.com/Reuters/worldNews",
            "BBC World":       "http://feeds.bbci.co.uk/news/world/rss.xml"
          }

          results = {}
          for name, url in feeds.items():
            try:
              resp = requests.get(url, timeout=15)
              resp.raise_for_status()
              count = len(feedparser.parse(resp.content).entries)
              results[name] = f"{count} items" if count else "ZERO"
            except Exception as e:
              results[name] = f"ERROR: {type(e).__name__}"

-         # export via GITHUB_OUTPUT
-         print("feed_status<<EOF", file=open(os.environ['GITHUB_OUTPUT'], 'a'))
-         print(json.dumps(results), file=open(os.environ['GITHUB_OUTPUT'], 'a'))
-         print("EOF", file=open(os.environ['GITHUB_OUTPUT'], 'a'))
+         # export via GITHUB_OUTPUT
+         with open(os.environ['GITHUB_OUTPUT'], 'a') as fh:
+             print("feed_status<<EOF", file=fh)
+             print(json.dumps(results), file=fh)
+             print("EOF", file=fh)
          EOF